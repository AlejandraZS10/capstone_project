{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 64,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>NODEID</th>\n",
       "      <th>ONSTREETNAME</th>\n",
       "      <th>FROMSTREETNAME</th>\n",
       "      <th>BOROUGH_CODE</th>\n",
       "      <th>WORK_START_DATE</th>\n",
       "      <th>WORK_END_DATE</th>\n",
       "      <th>PURPOSE</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>13010</td>\n",
       "      <td>CANAL AVENUE</td>\n",
       "      <td>WEST   17 STREET</td>\n",
       "      <td>B</td>\n",
       "      <td>05/17/2018 00:00:00</td>\n",
       "      <td>05/21/2018 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>13011</td>\n",
       "      <td>BELT PKWY EB EN CROPSEY AVE SB</td>\n",
       "      <td>BAY   52 STREET</td>\n",
       "      <td>B</td>\n",
       "      <td>05/17/2018 00:00:00</td>\n",
       "      <td>05/21/2018 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>108018</td>\n",
       "      <td>RIVERSIDE BOULEVARD</td>\n",
       "      <td>WEST   63 STREET</td>\n",
       "      <td>M</td>\n",
       "      <td>12/04/2017 00:00:00</td>\n",
       "      <td>12/05/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>101964</td>\n",
       "      <td>87 AVENUE</td>\n",
       "      <td>233 STREET</td>\n",
       "      <td>Q</td>\n",
       "      <td>10/06/2017 14:10:27</td>\n",
       "      <td>01/01/2018 23:58:59</td>\n",
       "      <td>DEP CONTRACTOR MAJOR INSTALLATION WATER</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>17361</td>\n",
       "      <td>AVENUE K</td>\n",
       "      <td>EAST    7 STREET</td>\n",
       "      <td>B</td>\n",
       "      <td>07/31/2017 00:00:00</td>\n",
       "      <td>08/02/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   NODEID                    ONSTREETNAME    FROMSTREETNAME BOROUGH_CODE  \\\n",
       "0   13010                    CANAL AVENUE  WEST   17 STREET            B   \n",
       "1   13011  BELT PKWY EB EN CROPSEY AVE SB   BAY   52 STREET            B   \n",
       "2  108018             RIVERSIDE BOULEVARD  WEST   63 STREET            M   \n",
       "3  101964                       87 AVENUE        233 STREET            Q   \n",
       "4   17361                        AVENUE K  EAST    7 STREET            B   \n",
       "\n",
       "       WORK_START_DATE        WORK_END_DATE  \\\n",
       "0  05/17/2018 00:00:00  05/21/2018 23:59:59   \n",
       "1  05/17/2018 00:00:00  05/21/2018 23:59:59   \n",
       "2  12/04/2017 00:00:00  12/05/2017 23:59:59   \n",
       "3  10/06/2017 14:10:27  01/01/2018 23:58:59   \n",
       "4  07/31/2017 00:00:00  08/02/2017 23:59:59   \n",
       "\n",
       "                                   PURPOSE  \n",
       "0                      DOT IN-HOUSE PAVING  \n",
       "1                      DOT IN-HOUSE PAVING  \n",
       "2                      DOT IN-HOUSE PAVING  \n",
       "3  DEP CONTRACTOR MAJOR INSTALLATION WATER  \n",
       "4                      DOT IN-HOUSE PAVING  "
      ]
     },
     "execution_count": 64,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import pandas as pd\n",
    "import geopandas as gpd\n",
    "\n",
    "#traffic volume csv\n",
    "df=pd.read_csv('https://raw.githubusercontent.com/AlejandraZS10/capstone_project/master/data/Street_Closures_due_to_construction_activities_by_Intersection.csv')\n",
    "df.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  },
  {
   "cell_type": "code",
   "execution_count": 65,
   "metadata": {},
   "outputs": [],
   "source": [
    "from datetime import datetime"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 66,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['DateTime'] = pd.to_datetime(df.WORK_START_DATE, format='%m/%d/%Y %H:%M:%S')\n",
    "df['DateTimeEnd'] = pd.to_datetime(df.WORK_END_DATE, format='%m/%d/%Y %H:%M:%S')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 67,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['Date'] = df['DateTime'].dt.date\n",
    "\n",
    "df['Time'] = df['DateTime'].dt.time\n",
    "\n",
    "df['year'] = df['DateTime'].dt.year\n",
    "\n",
    "df['month'] = df['DateTime'].dt.month\n",
    "\n",
    "df['day'] = df['DateTime'].dt.day\n",
    "\n",
    "df['DateEnd'] = df['DateTimeEnd'].dt.date\n",
    "\n",
    "df['Time'] = df['DateTimeEnd'].dt.time\n",
    "\n",
    "df['year'] = df['DateTimeEnd'].dt.year\n",
    "\n",
    "df['month'] = df['DateTimeEnd'].dt.month\n",
    "\n",
    "df['day'] = df['DateTimeEnd'].dt.day"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 68,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>NODEID</th>\n",
       "      <th>ONSTREETNAME</th>\n",
       "      <th>FROMSTREETNAME</th>\n",
       "      <th>BOROUGH_CODE</th>\n",
       "      <th>WORK_START_DATE</th>\n",
       "      <th>WORK_END_DATE</th>\n",
       "      <th>PURPOSE</th>\n",
       "      <th>DateTime</th>\n",
       "      <th>DateTimeEnd</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>DateEnd</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>13010</td>\n",
       "      <td>CANAL AVENUE</td>\n",
       "      <td>WEST   17 STREET</td>\n",
       "      <td>B</td>\n",
       "      <td>05/17/2018 00:00:00</td>\n",
       "      <td>05/21/2018 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2018-05-17 00:00:00</td>\n",
       "      <td>2018-05-21 23:59:59</td>\n",
       "      <td>2018-05-17</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2018</td>\n",
       "      <td>5</td>\n",
       "      <td>21</td>\n",
       "      <td>2018-05-21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>13011</td>\n",
       "      <td>BELT PKWY EB EN CROPSEY AVE SB</td>\n",
       "      <td>BAY   52 STREET</td>\n",
       "      <td>B</td>\n",
       "      <td>05/17/2018 00:00:00</td>\n",
       "      <td>05/21/2018 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2018-05-17 00:00:00</td>\n",
       "      <td>2018-05-21 23:59:59</td>\n",
       "      <td>2018-05-17</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2018</td>\n",
       "      <td>5</td>\n",
       "      <td>21</td>\n",
       "      <td>2018-05-21</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>108018</td>\n",
       "      <td>RIVERSIDE BOULEVARD</td>\n",
       "      <td>WEST   63 STREET</td>\n",
       "      <td>M</td>\n",
       "      <td>12/04/2017 00:00:00</td>\n",
       "      <td>12/05/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-12-04 00:00:00</td>\n",
       "      <td>2017-12-05 23:59:59</td>\n",
       "      <td>2017-12-04</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>5</td>\n",
       "      <td>2017-12-05</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>101964</td>\n",
       "      <td>87 AVENUE</td>\n",
       "      <td>233 STREET</td>\n",
       "      <td>Q</td>\n",
       "      <td>10/06/2017 14:10:27</td>\n",
       "      <td>01/01/2018 23:58:59</td>\n",
       "      <td>DEP CONTRACTOR MAJOR INSTALLATION WATER</td>\n",
       "      <td>2017-10-06 14:10:27</td>\n",
       "      <td>2018-01-01 23:58:59</td>\n",
       "      <td>2017-10-06</td>\n",
       "      <td>23:58:59</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2018-01-01</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>17361</td>\n",
       "      <td>AVENUE K</td>\n",
       "      <td>EAST    7 STREET</td>\n",
       "      <td>B</td>\n",
       "      <td>07/31/2017 00:00:00</td>\n",
       "      <td>08/02/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-07-31 00:00:00</td>\n",
       "      <td>2017-08-02 23:59:59</td>\n",
       "      <td>2017-07-31</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>2017-08-02</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22155</th>\n",
       "      <td>9005173</td>\n",
       "      <td>NYCTA SUBWAY</td>\n",
       "      <td>WOODWARD AVENUE</td>\n",
       "      <td>Q</td>\n",
       "      <td>09/05/2019 15:29:26</td>\n",
       "      <td>10/25/2019 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2019-09-05 15:29:26</td>\n",
       "      <td>2019-10-25 23:59:59</td>\n",
       "      <td>2019-09-05</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2019</td>\n",
       "      <td>10</td>\n",
       "      <td>25</td>\n",
       "      <td>2019-10-25</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22159</th>\n",
       "      <td>79222</td>\n",
       "      <td>WESTCHESTER AVENUE</td>\n",
       "      <td>WHITE PLAINS ROAD</td>\n",
       "      <td>X</td>\n",
       "      <td>10/07/2019 00:00:00</td>\n",
       "      <td>10/11/2019 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2019-10-07 00:00:00</td>\n",
       "      <td>2019-10-11 23:59:59</td>\n",
       "      <td>2019-10-07</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2019</td>\n",
       "      <td>10</td>\n",
       "      <td>11</td>\n",
       "      <td>2019-10-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22166</th>\n",
       "      <td>9029108</td>\n",
       "      <td>1 STREET</td>\n",
       "      <td>102 STREET</td>\n",
       "      <td>Q</td>\n",
       "      <td>08/27/2019 16:23:54</td>\n",
       "      <td>09/27/2019 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE MILLING</td>\n",
       "      <td>2019-08-27 16:23:54</td>\n",
       "      <td>2019-09-27 23:59:59</td>\n",
       "      <td>2019-08-27</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2019</td>\n",
       "      <td>9</td>\n",
       "      <td>27</td>\n",
       "      <td>2019-09-27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22167</th>\n",
       "      <td>9029108</td>\n",
       "      <td>1 STREET</td>\n",
       "      <td>102 STREET</td>\n",
       "      <td>Q</td>\n",
       "      <td>08/27/2019 16:23:55</td>\n",
       "      <td>09/27/2019 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2019-08-27 16:23:55</td>\n",
       "      <td>2019-09-27 23:59:59</td>\n",
       "      <td>2019-08-27</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2019</td>\n",
       "      <td>9</td>\n",
       "      <td>27</td>\n",
       "      <td>2019-09-27</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22174</th>\n",
       "      <td>9008781</td>\n",
       "      <td>CYRUS PLACE</td>\n",
       "      <td>PARK AVENUE</td>\n",
       "      <td>X</td>\n",
       "      <td>08/30/2019 00:00:00</td>\n",
       "      <td>10/01/2019 23:58:59</td>\n",
       "      <td>CONTRACT ROADWAY MILLING</td>\n",
       "      <td>2019-08-30 00:00:00</td>\n",
       "      <td>2019-10-01 23:58:59</td>\n",
       "      <td>2019-08-30</td>\n",
       "      <td>23:58:59</td>\n",
       "      <td>2019</td>\n",
       "      <td>10</td>\n",
       "      <td>1</td>\n",
       "      <td>2019-10-01</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>18500 rows Ã— 15 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "        NODEID                    ONSTREETNAME     FROMSTREETNAME  \\\n",
       "0        13010                    CANAL AVENUE   WEST   17 STREET   \n",
       "1        13011  BELT PKWY EB EN CROPSEY AVE SB    BAY   52 STREET   \n",
       "2       108018             RIVERSIDE BOULEVARD   WEST   63 STREET   \n",
       "3       101964                       87 AVENUE         233 STREET   \n",
       "4        17361                        AVENUE K   EAST    7 STREET   \n",
       "...        ...                             ...                ...   \n",
       "22155  9005173                    NYCTA SUBWAY    WOODWARD AVENUE   \n",
       "22159    79222              WESTCHESTER AVENUE  WHITE PLAINS ROAD   \n",
       "22166  9029108                        1 STREET         102 STREET   \n",
       "22167  9029108                        1 STREET         102 STREET   \n",
       "22174  9008781                     CYRUS PLACE        PARK AVENUE   \n",
       "\n",
       "      BOROUGH_CODE      WORK_START_DATE        WORK_END_DATE  \\\n",
       "0                B  05/17/2018 00:00:00  05/21/2018 23:59:59   \n",
       "1                B  05/17/2018 00:00:00  05/21/2018 23:59:59   \n",
       "2                M  12/04/2017 00:00:00  12/05/2017 23:59:59   \n",
       "3                Q  10/06/2017 14:10:27  01/01/2018 23:58:59   \n",
       "4                B  07/31/2017 00:00:00  08/02/2017 23:59:59   \n",
       "...            ...                  ...                  ...   \n",
       "22155            Q  09/05/2019 15:29:26  10/25/2019 23:59:59   \n",
       "22159            X  10/07/2019 00:00:00  10/11/2019 23:59:59   \n",
       "22166            Q  08/27/2019 16:23:54  09/27/2019 23:59:59   \n",
       "22167            Q  08/27/2019 16:23:55  09/27/2019 23:59:59   \n",
       "22174            X  08/30/2019 00:00:00  10/01/2019 23:58:59   \n",
       "\n",
       "                                       PURPOSE            DateTime  \\\n",
       "0                          DOT IN-HOUSE PAVING 2018-05-17 00:00:00   \n",
       "1                          DOT IN-HOUSE PAVING 2018-05-17 00:00:00   \n",
       "2                          DOT IN-HOUSE PAVING 2017-12-04 00:00:00   \n",
       "3      DEP CONTRACTOR MAJOR INSTALLATION WATER 2017-10-06 14:10:27   \n",
       "4                          DOT IN-HOUSE PAVING 2017-07-31 00:00:00   \n",
       "...                                        ...                 ...   \n",
       "22155                      DOT IN-HOUSE PAVING 2019-09-05 15:29:26   \n",
       "22159                      DOT IN-HOUSE PAVING 2019-10-07 00:00:00   \n",
       "22166                     DOT IN-HOUSE MILLING 2019-08-27 16:23:54   \n",
       "22167                      DOT IN-HOUSE PAVING 2019-08-27 16:23:55   \n",
       "22174                 CONTRACT ROADWAY MILLING 2019-08-30 00:00:00   \n",
       "\n",
       "              DateTimeEnd        Date      Time  year  month  day     DateEnd  \n",
       "0     2018-05-21 23:59:59  2018-05-17  23:59:59  2018      5   21  2018-05-21  \n",
       "1     2018-05-21 23:59:59  2018-05-17  23:59:59  2018      5   21  2018-05-21  \n",
       "2     2017-12-05 23:59:59  2017-12-04  23:59:59  2017     12    5  2017-12-05  \n",
       "3     2018-01-01 23:58:59  2017-10-06  23:58:59  2018      1    1  2018-01-01  \n",
       "4     2017-08-02 23:59:59  2017-07-31  23:59:59  2017      8    2  2017-08-02  \n",
       "...                   ...         ...       ...   ...    ...  ...         ...  \n",
       "22155 2019-10-25 23:59:59  2019-09-05  23:59:59  2019     10   25  2019-10-25  \n",
       "22159 2019-10-11 23:59:59  2019-10-07  23:59:59  2019     10   11  2019-10-11  \n",
       "22166 2019-09-27 23:59:59  2019-08-27  23:59:59  2019      9   27  2019-09-27  \n",
       "22167 2019-09-27 23:59:59  2019-08-27  23:59:59  2019      9   27  2019-09-27  \n",
       "22174 2019-10-01 23:58:59  2019-08-30  23:58:59  2019     10    1  2019-10-01  \n",
       "\n",
       "[18500 rows x 15 columns]"
      ]
     },
     "execution_count": 68,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.loc[df['year'] < 2020]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 69,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['difference']= df['DateTimeEnd'] - df['DateTime']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 70,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.lower()\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.lower()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 71,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('east ', 'e ') \n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('west ', 'w ') \n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('pkwy ', ' parkway ') \n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('blvd ', ' boulevard') \n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('pl ', ' place') \n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace(' rd', ' road')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('ave ', 'avenue ')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace(' ln', ' lane')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('dvwy ', ' driveway')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('dr ', ' drive')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('expy ', ' expresspway')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('tunl ', ' tunnel')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('brg ', ' bridge')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('sq ', ' square')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('plz ', ' plaza')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('cir ', ' circle')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('tpke ', ' turnpike')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('cres ', ' crescent')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('fwy ', ' freeway')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('appr ', ' approach')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('lk ', ' lake')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('hwy ', ' highway')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('hts ', ' heights')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('grn ', ' green')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('pth ', ' path')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('drwy ', ' driveway')\n",
    "df['ONSTREETNAME'] = df['ONSTREETNAME'].str.replace('rdg ', ' ridge')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 72,
   "metadata": {},
   "outputs": [],
   "source": [
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('east ', 'e ') \n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('west ', 'w ') \n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('pkwy ', ' parkway ') \n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('blvd ', ' boulevard') \n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('pl ', ' place') \n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('rd ', ' road')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('ave ', 'avenue ')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('ln ', ' lane')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('dvwy ', ' driveway')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('dr ', ' drive')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('expy ', ' expresspway')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('tunl ', ' tunnel')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('brg ', ' bridge')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('sq ', ' square')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('plz ', ' plaza')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('cir ', ' circle')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('tpke ', ' turnpike')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('cres ', ' crescent')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('fwy ', ' freeway')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('appr ', ' approach')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('lk ', ' lake')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('hwy ', ' highway')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('hts ', ' heights')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('grn ', ' green')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('pth ', ' path')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('drwy ', ' driveway')\n",
    "df['FROMSTREETNAME'] = df['FROMSTREETNAME'].str.replace('rdg ', ' ridge')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 73,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>NODEID</th>\n",
       "      <th>ONSTREETNAME</th>\n",
       "      <th>FROMSTREETNAME</th>\n",
       "      <th>BOROUGH_CODE</th>\n",
       "      <th>WORK_START_DATE</th>\n",
       "      <th>WORK_END_DATE</th>\n",
       "      <th>PURPOSE</th>\n",
       "      <th>DateTime</th>\n",
       "      <th>DateTimeEnd</th>\n",
       "      <th>Date</th>\n",
       "      <th>Time</th>\n",
       "      <th>year</th>\n",
       "      <th>month</th>\n",
       "      <th>day</th>\n",
       "      <th>DateEnd</th>\n",
       "      <th>difference</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>13010</td>\n",
       "      <td>canal avenue</td>\n",
       "      <td>w   17 street</td>\n",
       "      <td>B</td>\n",
       "      <td>05/17/2018 00:00:00</td>\n",
       "      <td>05/21/2018 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2018-05-17 00:00:00</td>\n",
       "      <td>2018-05-21 23:59:59</td>\n",
       "      <td>2018-05-17</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2018</td>\n",
       "      <td>5</td>\n",
       "      <td>21</td>\n",
       "      <td>2018-05-21</td>\n",
       "      <td>4 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>13011</td>\n",
       "      <td>belt  parkway eb en cropsey avenue sb</td>\n",
       "      <td>bay   52 street</td>\n",
       "      <td>B</td>\n",
       "      <td>05/17/2018 00:00:00</td>\n",
       "      <td>05/21/2018 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2018-05-17 00:00:00</td>\n",
       "      <td>2018-05-21 23:59:59</td>\n",
       "      <td>2018-05-17</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2018</td>\n",
       "      <td>5</td>\n",
       "      <td>21</td>\n",
       "      <td>2018-05-21</td>\n",
       "      <td>4 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>108018</td>\n",
       "      <td>riverside boulevard</td>\n",
       "      <td>w   63 street</td>\n",
       "      <td>M</td>\n",
       "      <td>12/04/2017 00:00:00</td>\n",
       "      <td>12/05/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-12-04 00:00:00</td>\n",
       "      <td>2017-12-05 23:59:59</td>\n",
       "      <td>2017-12-04</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>12</td>\n",
       "      <td>5</td>\n",
       "      <td>2017-12-05</td>\n",
       "      <td>1 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>101964</td>\n",
       "      <td>87 avenue</td>\n",
       "      <td>233 street</td>\n",
       "      <td>Q</td>\n",
       "      <td>10/06/2017 14:10:27</td>\n",
       "      <td>01/01/2018 23:58:59</td>\n",
       "      <td>DEP CONTRACTOR MAJOR INSTALLATION WATER</td>\n",
       "      <td>2017-10-06 14:10:27</td>\n",
       "      <td>2018-01-01 23:58:59</td>\n",
       "      <td>2017-10-06</td>\n",
       "      <td>23:58:59</td>\n",
       "      <td>2018</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>2018-01-01</td>\n",
       "      <td>87 days 09:48:32</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>17361</td>\n",
       "      <td>avenue k</td>\n",
       "      <td>e    7 street</td>\n",
       "      <td>B</td>\n",
       "      <td>07/31/2017 00:00:00</td>\n",
       "      <td>08/02/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-07-31 00:00:00</td>\n",
       "      <td>2017-08-02 23:59:59</td>\n",
       "      <td>2017-07-31</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>21263</td>\n",
       "      <td>dyer avenue</td>\n",
       "      <td>w   37 street</td>\n",
       "      <td>M</td>\n",
       "      <td>10/10/2017 00:00:00</td>\n",
       "      <td>10/11/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-10-10 00:00:00</td>\n",
       "      <td>2017-10-11 23:59:59</td>\n",
       "      <td>2017-10-10</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>10</td>\n",
       "      <td>11</td>\n",
       "      <td>2017-10-11</td>\n",
       "      <td>1 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>21226</td>\n",
       "      <td>11 avenue</td>\n",
       "      <td>w   43 street</td>\n",
       "      <td>M</td>\n",
       "      <td>11/06/2017 00:00:00</td>\n",
       "      <td>11/07/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-11-06 00:00:00</td>\n",
       "      <td>2017-11-07 23:59:59</td>\n",
       "      <td>2017-11-06</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>11</td>\n",
       "      <td>7</td>\n",
       "      <td>2017-11-07</td>\n",
       "      <td>1 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>17414</td>\n",
       "      <td>avenue k</td>\n",
       "      <td>e    8 street</td>\n",
       "      <td>B</td>\n",
       "      <td>07/31/2017 00:00:00</td>\n",
       "      <td>08/02/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-07-31 00:00:00</td>\n",
       "      <td>2017-08-02 23:59:59</td>\n",
       "      <td>2017-07-31</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>17416</td>\n",
       "      <td>avenue k</td>\n",
       "      <td>e    9 street</td>\n",
       "      <td>B</td>\n",
       "      <td>07/31/2017 00:00:00</td>\n",
       "      <td>08/02/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-07-31 00:00:00</td>\n",
       "      <td>2017-08-02 23:59:59</td>\n",
       "      <td>2017-07-31</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2 days 23:59:59</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>17418</td>\n",
       "      <td>avenue k</td>\n",
       "      <td>e   10 street</td>\n",
       "      <td>B</td>\n",
       "      <td>07/31/2017 00:00:00</td>\n",
       "      <td>08/02/2017 23:59:59</td>\n",
       "      <td>DOT IN-HOUSE PAVING</td>\n",
       "      <td>2017-07-31 00:00:00</td>\n",
       "      <td>2017-08-02 23:59:59</td>\n",
       "      <td>2017-07-31</td>\n",
       "      <td>23:59:59</td>\n",
       "      <td>2017</td>\n",
       "      <td>8</td>\n",
       "      <td>2</td>\n",
       "      <td>2017-08-02</td>\n",
       "      <td>2 days 23:59:59</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "   NODEID                           ONSTREETNAME   FROMSTREETNAME  \\\n",
       "0   13010                           canal avenue    w   17 street   \n",
       "1   13011  belt  parkway eb en cropsey avenue sb  bay   52 street   \n",
       "2  108018                    riverside boulevard    w   63 street   \n",
       "3  101964                              87 avenue       233 street   \n",
       "4   17361                               avenue k    e    7 street   \n",
       "5   21263                            dyer avenue    w   37 street   \n",
       "6   21226                              11 avenue    w   43 street   \n",
       "7   17414                               avenue k    e    8 street   \n",
       "8   17416                               avenue k    e    9 street   \n",
       "9   17418                               avenue k    e   10 street   \n",
       "\n",
       "  BOROUGH_CODE      WORK_START_DATE        WORK_END_DATE  \\\n",
       "0            B  05/17/2018 00:00:00  05/21/2018 23:59:59   \n",
       "1            B  05/17/2018 00:00:00  05/21/2018 23:59:59   \n",
       "2            M  12/04/2017 00:00:00  12/05/2017 23:59:59   \n",
       "3            Q  10/06/2017 14:10:27  01/01/2018 23:58:59   \n",
       "4            B  07/31/2017 00:00:00  08/02/2017 23:59:59   \n",
       "5            M  10/10/2017 00:00:00  10/11/2017 23:59:59   \n",
       "6            M  11/06/2017 00:00:00  11/07/2017 23:59:59   \n",
       "7            B  07/31/2017 00:00:00  08/02/2017 23:59:59   \n",
       "8            B  07/31/2017 00:00:00  08/02/2017 23:59:59   \n",
       "9            B  07/31/2017 00:00:00  08/02/2017 23:59:59   \n",
       "\n",
       "                                   PURPOSE            DateTime  \\\n",
       "0                      DOT IN-HOUSE PAVING 2018-05-17 00:00:00   \n",
       "1                      DOT IN-HOUSE PAVING 2018-05-17 00:00:00   \n",
       "2                      DOT IN-HOUSE PAVING 2017-12-04 00:00:00   \n",
       "3  DEP CONTRACTOR MAJOR INSTALLATION WATER 2017-10-06 14:10:27   \n",
       "4                      DOT IN-HOUSE PAVING 2017-07-31 00:00:00   \n",
       "5                      DOT IN-HOUSE PAVING 2017-10-10 00:00:00   \n",
       "6                      DOT IN-HOUSE PAVING 2017-11-06 00:00:00   \n",
       "7                      DOT IN-HOUSE PAVING 2017-07-31 00:00:00   \n",
       "8                      DOT IN-HOUSE PAVING 2017-07-31 00:00:00   \n",
       "9                      DOT IN-HOUSE PAVING 2017-07-31 00:00:00   \n",
       "\n",
       "          DateTimeEnd        Date      Time  year  month  day     DateEnd  \\\n",
       "0 2018-05-21 23:59:59  2018-05-17  23:59:59  2018      5   21  2018-05-21   \n",
       "1 2018-05-21 23:59:59  2018-05-17  23:59:59  2018      5   21  2018-05-21   \n",
       "2 2017-12-05 23:59:59  2017-12-04  23:59:59  2017     12    5  2017-12-05   \n",
       "3 2018-01-01 23:58:59  2017-10-06  23:58:59  2018      1    1  2018-01-01   \n",
       "4 2017-08-02 23:59:59  2017-07-31  23:59:59  2017      8    2  2017-08-02   \n",
       "5 2017-10-11 23:59:59  2017-10-10  23:59:59  2017     10   11  2017-10-11   \n",
       "6 2017-11-07 23:59:59  2017-11-06  23:59:59  2017     11    7  2017-11-07   \n",
       "7 2017-08-02 23:59:59  2017-07-31  23:59:59  2017      8    2  2017-08-02   \n",
       "8 2017-08-02 23:59:59  2017-07-31  23:59:59  2017      8    2  2017-08-02   \n",
       "9 2017-08-02 23:59:59  2017-07-31  23:59:59  2017      8    2  2017-08-02   \n",
       "\n",
       "        difference  \n",
       "0  4 days 23:59:59  \n",
       "1  4 days 23:59:59  \n",
       "2  1 days 23:59:59  \n",
       "3 87 days 09:48:32  \n",
       "4  2 days 23:59:59  \n",
       "5  1 days 23:59:59  \n",
       "6  1 days 23:59:59  \n",
       "7  2 days 23:59:59  \n",
       "8  2 days 23:59:59  \n",
       "9  2 days 23:59:59  "
      ]
     },
     "execution_count": 73,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.head(10)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 74,
   "metadata": {},
   "outputs": [],
   "source": [
    "df.to_csv('closed_streets.csv')"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.7.6"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 4
}
